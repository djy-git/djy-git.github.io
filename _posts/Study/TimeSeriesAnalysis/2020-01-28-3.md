---
title: 3. ARIMA models - ACF, PACF
tags: Study_TimeSeriesAnalysis
aside:
  toc: true
---

# Remarks
본 글은 [한양대학교 이기천 교수님의 시계열분석 강의 3강](https://youtu.be/QVUEpSofpU0)을 정리한 글입니다.

<!--more-->

---

이전 강의까지 trend를 찾아내는 몇 가지 방법들을 배웠다. <br>
찾아낸 trend를 제거하면 residual이 남게 되는데, 이번 강의부터는 residual을 modeling하는 방법에 대해 배운다. <br>


# 1. Autoregressive model
## 1) AR(1)
$$
\begin{equation}
\begin{aligned}
    x_t &= \phi x_{t-1} + a_t + \mu \\
    &= \phi(\phi x_{t-2} + a_{t-1} + \mu) + a_t + \mu \\
    &= \ ... \\
    &= a_t + \phi a_{t-1} + \phi^2 a_{t-2} + \cdots \\
    &\ \quad \mu + \phi \mu + \phi^2 \mu + \cdots \\
    &= \phi^m x_{t-m} + \phi^{m-1} a_{t-(m-1)} + \cdots + a_t + (\phi^{m-1} + \cdots + 1) \mu \\
    &\approx a_t + \cdots + \phi^{m-1} a_{t-(m-1)} + (1 + \cdots + \phi^{m-1}) \mu \quad \text{ if } \mid \phi \mid < 1 \text{ and } m \text{ is sufficiently large} \\
    &\approx a_t + \cdots + \phi^{m-1} a_{t-(m-1)} + \frac{\mu}{1 - \phi}
\end{aligned}
\end{equation}
$$

### - Expectation
$$
\begin{equation}
\begin{aligned}
    E(x_t) &= E(\phi x_{t-1} + a_t + \mu) \\
    &= \phi E(x_{t-1}) + \mu \quad \text{ if } \ E(x_t) = E(x_{t-1}) \\
    E(x_t) &= \frac{\mu}{1-\phi}
\end{aligned}
\end{equation}
$$

즉, $\mid \phi \mid < 1$ 조건이 주어졌을 때, 그리고 $E(x_t)$와 $E(x_t) = E(x_{t-1}$ 조건이 주어졌을 때의 $E(x_t)$가 $\frac{\mu}{1 - \phi}$로 동일하다. <br>

### - Variance
$$
\begin{equation}
\begin{aligned}
    Var(x_t) &= Var(a_t + \cdots + \phi^{m-1} a_{t-(m-1)} + \frac{\mu}{1 - \phi}) \\
    &= Var(a_t) + \cdots + \phi^{2(m-1)} Var(a_{t-(m-1)}) \\
    &= \sigma^2 + \cdots + \phi^{2(m-1)}\sigma^2 \\
    &= \frac{\sigma^2}{1 - \phi^2} \\
\end{aligned}
\end{equation}
$$

Expectation과 마찬가지로, $\mid \phi \mid < 1$ 조건에서 $Var(x_t) = Var(x_{t-1})$ 조건이 주어진 경우와 동일한 결과를 보인다. <br>

### - Covariance
$Cov(x_t, a_{t+1}) = 0$ <br>
왜냐하면 $x_t$는 $a_t, a_{t-1}, \cdots$ 들로 구성되지만, $a_{t-h}$는 $a_{t+1}$과 독립이기 때문에 covariance가 0이다. <br>

## 2) Causality
$x_t = f(a_t, a_{t-1}, \cdots)$ 인 system을 **causal** system이라고 한다. <br>
즉, 현재의 observation이 현재의 noise와 이전의 noise들에 의해서 표현되는 system을 causal system이라고 부른다. <br>

- **Causal ARMA model** <br>
$x_t = \theta_0 a_t - \theta_1 a_{t-1} - \cdots$ &emsp; ($\theta_0 = 1$) <br>
$\sum_{j=0}^\infty \mid \theta_j \mid < \infty$ (bounded) <br>
<br>
AR(1)이 causal ARMA model이 되기 위해선, $\mid \phi \mid < 1$ 조건이 필요하다. (stationary 조건과 동일) <br>
<br>
ex) $x_t = 2x_{t-1} - a_t$ 는 causal system이 아니다. <br>
$$
\begin{equation}
\begin{aligned}
    x_t &= 2x_{t-1} - a_t \\
    x_{t-1} &= \frac{1}{2}x_t + \frac{a_t}{2} \\
    &= \frac{a_t}{2} + \frac{a_{t+1}}{2^2} + \frac{x_{t+1}}{2^2} \\
    &= \frac{a_t}{2} + \frac{a_{t+1}}{2^2} + \frac{a_{t+2}}{2^3} + \cdots
\end{aligned}
\end{equation}
$$
<br> 혹은, <br>
$$
\begin{equation}
\begin{aligned}
    x_t &= 2x_{t-1} - a_t \\
    &= 2^m x_{t-m} + 2^{m-1}a_{t-(m-1)} + \cdots + 2 a_{t-1} + a_t
\end{aligned}
\end{equation}
$$
<br>
Stationary하지만, causal system은 아니다.

- **Stationary and Causal system** <br>
우리가 분석할 대상은 stationary 하면서도 causal한 system이다. <br>
이를 위해서, 다음과 같은 causal model을 가정한다. <br>
$x_t$ and $a_{t+1}$ are not correlated <br>

## 3) AR(2)



---

ㅁㄴㅇ
